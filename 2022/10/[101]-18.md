## 목차
[1. MongoDB](#mongodb)   
[2. Cloud Front](#cloudfront)   
[3. Bastion Host](#bastionhost)   

## MongoDB
몽고디비 쿼리를 체크했다.
aggregation을 사용해서 쿼리를 짰는데 익숙하지 않았다. `$unwind`도 배웠고 체크 할 부분은 많았다. 다음에 또 쿼리를 짜게 된다면 조금은 수월하길 바란다.. 공부가 필요하다고 느낀 부분이다.

## CloudFront

> Cloud Front : CDN
-> S3 버킷
1. 정적 웹 호스팅 (경로 생성 시 루트 경로 지정, 폴더 안에 넣고 싶으면 폴더 경로도 같이 지정 필요)
2. 엔드 포인트 생성
3.  생성된 엔드 포인트는 경로가 AWS 제공 경로여서 사용자가 접근 하기엔 용이하지 않음
4. Cloud Front로 대체 도메인 이름 생성 및 설정
5.  Cloud Front 무효화 진행 (캐시 다시 잡아준다고 보면 됨, 기존 띄워진 페이지를 대체하고 새로 배포된 페이지를 띄워지기 위해..)
6.  다른 페이지에서는 퍼지 기능으로 보면 된다.

## BastionHost

배스천은 중세시대 적을 효과적으로 막을 수 있던 성 외곽을 말한다. 네트워크에서도 역시 보안상 가장 중요한 방화벽 호스트를 담당하게 된다.

보안이 중요하므로 배스천 호스트 내 불필요한 패키지는 모두 삭제하는 게 좋다.

배스천 호스트에서 내부 프라이빗 호스트에 접근하기 위해 2가지 방법이 있다.

1. 배스천 호스트에 개인 키 저장
2. ssh-agent 전달

1번 경우 배스천이 타격을 입으면 모든 호스트가 타격을 입게 되므로 추천하지 않는다.

2번 경우가 좋은 사용법인데 배스천 및 인스턴스 모두 동일한 키 쌍을 사용하더라도 ssh-agent를 전달해야 한다.

> 2. 입장
```shell
# ssh-agent 등록
ssh-add -k .pem

# ssh-agent 조회
ssh-add -l

# pem 가지고 public 입장
ssh -A ec2-user@PublicIP

# public에서 private로 입장 
ssh -v ec2-user@PrivateIP
```
agent에 pem을 등록했다면 pem 경로에 상관 없이 agent를 조회해 알아서 들어가진다. 하지만 `ssh-add -l` 로 조회를 해보면 결과가 나타나지 않는다. 때문에 입장 할 때는 `-A` 옵션을 활용해서 입장해야 한다.

ssh-agnet에 pem은 5개 이하로 등록하고 관리하는 게 좋다. 5개까지 조회해 알아서 접속하기 때문이다.
